import { CodeBlock } from "@/components/CodeBlock";

# 從零開始的Angular教學
> 課程時間：約1個下午到1周

# GFM

## Autolink literals

www.example.com, https://example.com, and contact@example.com.

## Footnote

A note[^1]

[^1]: Big note.

## Strikethrough

~one~ or ~~two~~ tildes.

## Table

| a | b  |  c |  d  |
| - | :- | -: | :-: |

## Tasklist

* [ ] to do
* [x] done

---

## 零、Angular是啥？
![AngularImg](https://angular.io/assets/images/logos/angular/angular.svg)
> 圖片來自：[Angular正體中文站](https://angular.tw/)

### 1. 為什麼前端框架？
jQuery + Bootstrap不是很好嗎？為啥冒出像是React、Angular、Vue這種東東？

簡單來說，如果你的專案中會==重複使用到一些元件、前端可能需要處理並顯示複雜的後端回傳資料、想要提升使用者體驗==。那你最好使用一個前端的框架來幫助你開發。

> 延伸閱讀：[Do We Really Need a Front-end Framework?](https://medium.com/swlh/do-we-really-need-a-front-end-framework-e8c8c3e4df0b)

### 2. 我該用哪個前端框架呢?
> 資料來源：[Angular vs React vs Vue: Which Framework to Choose](https://www.codeinwp.com/blog/angular-vs-vue-vs-react/)

前端框架不只一種，所以我們稍微比較一下最紅的三個吧：
*(2021/05/03 更新)*
|               |   Angular   |     React      |       Vue       |
| ------------- | ----------- | -------------- | --------------- |
|      釋出時間 |    2010     |      2013      |      2014       |
|          官網 | angular.io  |  reactjs.org   |    vuejs.org    |
| 大約大小 (KB) |     500     |      100       |       80        |
|      目前版本 |     11      |      17.X      |      3.0.X      |
|      使用企業 | Google, Wix | Facebook, Uber | Alibaba, GitLab |

如果我的時間不多，想要學習CP值最高的框架，有推薦的嗎？
我們來看看工作機會吧：
|    工作需求 | Angular | React |  Vue  |
| -----------:|:-------:|:-----:|:-----:|
|    LinkedIn |  72747  | 70963 | 11590 |
|      Indeed |  15141  | 14595 | 1810  |
| SimplyHired |  11357  | 10508 | 1526  |
|        Dice |  4719   | 3529  |  331  |
|   AngelList |  2350   | 4383  |  419  |
|       Hired |   13    |   9   |   0   |
|      Remote |  1069   | 1136  |  166  |

開發者們最愛的框架？
*(2021/05/03 更新)*
| Github Repo    | Angular | React |  Vue  |
| -------------- |:-------:|:-----:|:-----:|
| # Watchers     |  3.2k   | 6.7k  | 6.3k  |
| # Stars        |   72.9k   | 168k  | 183k  |
| # Forks        |  19.1k  | 33.8k | 28.9k |
| # Contributors |  1,398  | 1,542 |  399  |
| # Used By |  1.8m  | 6.3m |  144k  |

綜合上面的表格看起來企業好像比較喜歡Angular跟React，Vue可能因為比較新所以工作機會比較少，但是因為輕量且來自開源社群所以深受開發者們愛戴呢。

### 3. 我看完第2點了，不過我有些問題！
**Q1：為甚麼Angular的大小最大啊？**
**A1：**
 - 如果你使用React或Vue，你需要某些功能，譬如說PWA，你可能需要東裝一個套件西裝一個套件，最後可能還要自己處理Service Worker的註冊問題。
 - 但如果你使用Angular呢？
   只要輸入：`ng add @angular/pwa`
   噹啷~你的專案就會自動註冊Service Worker跟自動配置manifest的cache項目囉~
 - Angular的Package Size最大的原因就是因為它已經把你需要的東西都準備好了，==你只需要透過Angular CLI就可以完成多數專案的操作==。

**Q2：為什麼企業會偏愛Angular呢？**
**A2：**
 1. **Typescript**：最大的原因是因為Angular預設使用Typescript，還不知道Typescript的同學就想像是強型態、更加物件導向化的Javascript。Typescript相較Javascript更適合用來開發更大更複雜的專案，除了語法差別外Typescript還有一個特點就是它要透過編譯轉換成Javascript，==透過Typescript編譯器可以向下編譯Javascript支援舊版的瀏覽器==。
 2. **Google**，Angular的開發者是Google，所以跟很多Google的產品有深度的結合。例如Google的Firebase，==使用[Angular Fire](https://github.com/angular/angularfire)就可以很簡單的對Firebase操作，結合Firebase可以減少佈署的時間因為資料庫和後端都在Firebase上了。
 3. **測試環境**：Angular原生支援使用Jasmine + Karma進行單元測試。

**Q3：為什麼喜歡Angular的人好像不是很多？**
**A3：**
 - 簡單來說...
   ![Angular_Learning_Curve](https://hackmd.io/_uploads/BkWECrgBA.png)
 - Angular是上面三的框架中學習曲線最陡峭的。想像Angular是一個前端完整解決方案，不管你有什麼需求它幾乎都可以完成。但是也因為功能很多很齊全，要學習的東西也會變的更多更複雜。

---

## 一、先安裝Node.js和Angular CLI
1. 在開始學習Angular前，我們要先安裝Nodejs。
   Windows跟MacOS的使用者可以去Node的[**官方下載頁面**](https://nodejs.org/zh-tw/download/)下載安裝檔。
   Linux使用者請自行參考不同發行版的安裝方式，請注意要安裝Node最新LTS以上的版本。
   > [使用套件管理工具安裝](https://nodejs.org/en/download/package-manager/#debian-and-ubuntu-based-linux-distributions-enterprise-linux-fedora-and-snap-packages)
   > Debian / Ubuntu / deb / rpm / snap $\rightarrow$ [Binary發行版安裝](https://github.com/nodesource/distributions/blob/master/README.md)
    
   安裝完後確定一下Node版本>=LTS，並且npm也有成功安裝。
   ![node_version](https://i.imgur.com/0qwDYzo.png)

   *在本教學文中會使用 npm 作為套件管理工具，如果你要用其他工具例如 yarn 也可以，但是要注意套件管理工具不可以混用喔。*

2. 安裝Angular CLI
   `npm i -g @angular/cli`
   等npm安裝完後輸入：`ng --version`
   應該會看到類似的東西
   ![ng_version](https://i.imgur.com/6C0e2Xc.png)



---


## 二、我準備好了
很好，來開始第一個Angular專案。
我們利用一個簡單的代辦事項清單網頁來認識一下Angular的各個面向。

### 功能需求
1. 新增/刪除/修改/查詢代辦事項
2. 網頁要可以被安裝(PWA)

### 非功能需求
1. 介面不能太醜
2. 簡單的RWD
3. ~~我不想架設後端~~

### 開始寫程式囉
*現在11啦rrrrr*
~~*ㄎㄅ...寫到這裡的時候Angular更新10版了辣*~~
~~*反正我先用Angular 9寫，應該不會差太多。*~~

*Angular有提供版本更新教學，請參考：https://update.angular.io/*

> 你可以在 Github 找到完整的專案原始碼：
> https://github.com/stanley2058/AngularExample.git

#### 1. 建立Angular專案
建立Angular專案非常的簡單，打開你的命令列輸入：`ng new TodoList`
使用Angular routing，然後我們先用CSS就好。

<CodeBlock lang="bash">
{`
> ng new TodoList
? Would you like to add Angular routing? Yes
? Which stylesheet format would you like to use? CSS
`}
</CodeBlock>

等待Angular CLI安裝完需要的東西後就建立好專案了。
很喜歡版控的同學不用擔心，Angular CLI建立專案時就會幫我們初始化本地端的Git Repository了。

#### 2. 執行Angular開發用Server
進入**TodoList資料夾**，在命令列輸入：`ng serve --open`
等編譯完它就會幫你開啟網頁。
開起來後會看到類似這樣的頁面，這是Angular自動生成的首頁。
[![angular_fp](https://i.imgur.com/wIScyE1.png)](https://i.imgur.com/wIScyE1.png)

*(點圖片可以看全圖)*

#### 3. 修改首頁
來修改一下首頁，但是打開src/index.html卻看起來好像不對？
body裡面只有一個 `<app-root></app-root>` 欸！？

別急，app-root是component的selector。
說明一下，我們可以在自己定義的元件(component)裡面定義選取名稱(selector)，而當我們在html template裡面使用我們定義的selector時Angular會自己幫我們帶入該元件。

所以實際上現在顯示的東西應該在AppComponent裡面，打開app/app.component.html就會看到現在顯示在網頁上的東西了。

把app.component.html裡面的東西全選然後刪掉留下 `<router-outlet></router-outlet>` ，儲存後就會看到網頁自動更新成空白畫面了。

==注意：\<router-outlet\>\</router-outlet\>是Angular Router的根元素，Angular Router會把\<router-outlet\>\</router-outlet\>替換成對應的template。==

---

為了方便，我們使用Angular Material來幫我們快速建立各種元件。
`ng add @angular/material`
先選擇一些基本的東西：

<CodeBlock lang="bash">
{`
Installing packages for tooling via npm.
Installed packages for tooling via npm.
? Choose a prebuilt theme name, or "custom" for a custom theme: Indigo/Pink        [ Preview: https://material.angular.io?theme=indigo-pink ]
? Set up global Angular Material typography styles? Yes
  ? Set up browser animations for Angular Material? Yes
UPDATE package.json (1349 bytes)
  √ Packages installed successfully.
  UPDATE src/app/app.module.ts (502 bytes)
  UPDATE angular.json (3748 bytes)
  UPDATE src/index.html (511 bytes)
UPDATE src/styles.css (181 bytes)
`}
</CodeBlock>

---

再來，我們新增一個元件來作為TodoList的主要頁面。
`ng g c todo-page`
> *`ng g c $component` 等於 `ng generate component $component`*

建立完成之後網頁並沒有變化？
對，因為我們要把建立完的元件放進來才會正常顯示。
一般來說只要像使用一般html tag一樣把selector放進html template就可以了，但是現在我們需要把首頁導向到todo-page，所以我們要設定Angular Rotuer的路由。

打開app/app-routing.module.ts
並在routes裡面新增對應的參數。
path是網址列host後面的路徑，component則是要routing到的元件。

<CodeBlock lang="typescript">
{`
import { NgModule } from '@angular/core';
import { Routes, RouterModule } from '@angular/router';


const routes: Routes = [
    { path: "", component: TodoPageComponent }
];

@NgModule({
    imports: [RouterModule.forRoot(routes)],
    exports: [RouterModule]
})
export class AppRoutingModule { }
`}
</CodeBlock>

儲存後在首頁就會看到 `todo-page works!`。
   
#### 4. 新增一個網站header
首先，我們先建立一個header元件。
`ng g c header`
到app/app.module.ts裡面引入Angular Material的元件。

<CodeBlock lang="typescript">
{`
import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';

import { AppRoutingModule } from './app-routing.module';
import { BrowserAnimationsModule } from '@angular/platform-browser/animations';

// angular material import
import { MatToolbarModule } from '@angular/material/toolbar';
import { MatMenuModule } from '@angular/material/menu';
import { MatIconModule } from '@angular/material/icon';
import { MatButtonModule } from '@angular/material/button';

// component import
import { AppComponent } from './app.component';
import { TodoPageComponent } from './todo-page/todo-page.component';
import { HeaderComponent } from './header/header.component';

@NgModule({
  declarations: [
    AppComponent,
    TodoPageComponent,
    HeaderComponent
  ],
  imports: [
    BrowserModule,
    AppRoutingModule,
    BrowserAnimationsModule,
    MatToolbarModule,
    MatMenuModule,
    MatIconModule,
    MatButtonModule,
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }
`}
</CodeBlock>

完成header.component.html的內容

<CodeBlock lang="html">
{`
<mat-toolbar color="primary">
    <div>Todo List</div>
    <div class="navRightButton">
        <button mat-icon-button [matMenuTriggerFor]="appMenu" aria-label="Example icon-button with a menu">
            <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #appMenu="matMenu">
            <button mat-menu-item><mat-icon>list</mat-icon>Todo List</button>
            <button mat-menu-item><mat-icon>info</mat-icon>About</button>
        </mat-menu>
    </div>
</mat-toolbar>
`}
</CodeBlock>

加上一點style，header.component.css

<CodeBlock lang="css">
{`
.navRightButton {
    position: absolute;
    right: 20px;
}
`}
</CodeBlock>

最後到todo-page.component.html裡面加上header的tag
<CodeBlock lang="html">
{`
<div>
    <app-header></app-header>
</div>
`}
</CodeBlock>

儲存後應該會看到類似的畫面：
![todoList-header](https://i.imgur.com/qBD2MW0.png)


這樣就完成了一個可以重複使用的header元件。


#### 5. 完成 TODO List 頁面的內容
現在要製作一個簡單的清單可以新增、刪除跟修改代辦事項

在開始前，我們需要加入一些 Angular Material 的引入到 `app.module.ts` 裡面。

現在變成這樣：

<CodeBlock lang="typescript">
{`
import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';

import { AppRoutingModule } from './app-routing.module';
import { BrowserAnimationsModule } from '@angular/platform-browser/animations';

// angular material import
import { MatToolbarModule } from '@angular/material/toolbar';
import { MatMenuModule } from '@angular/material/menu';
import { MatIconModule } from '@angular/material/icon';
import { MatButtonModule } from '@angular/material/button';
import { MatCardModule } from '@angular/material/card';
import { MatListModule } from '@angular/material/list';
import { MatCheckboxModule } from '@angular/material/checkbox';
import { MatTooltipModule } from '@angular/material/tooltip';
import { MatInputModule } from '@angular/material/input';

// component import
import { AppComponent } from './app.component';
import { TodoPageComponent } from './todo-page/todo-page.component';
import { HeaderComponent } from './header/header.component';

@NgModule({
  declarations: [
    AppComponent,
    TodoPageComponent,
    HeaderComponent
  ],
  imports: [
    BrowserModule,
    AppRoutingModule,
    BrowserAnimationsModule,
    MatToolbarModule,
    MatMenuModule,
    MatIconModule,
    MatButtonModule,
    MatCardModule,
    MatListModule,
    MatCheckboxModule,
    MatTooltipModule,
    MatInputModule,
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }
`}
</CodeBlock>
